Microsat:

Author:  Murray Cox <murray.p.cox@gmail.com>
Date:    August 2007

Original code:  Richard Hudson (University of Chicago)


Reads coalescent genealogies generated by Richard Hudson's ms and
translates them into short tandem repeat (STR, or microsatellite)
datasets using the single step mutation model (SMM).  Microsat can
accommodate arbitrarily complex demographies, and generates either
unlinked autosomal datasets (for a single STR locus) or fully-linked
datasets (for multiple STR loci located in a genomic region with no
recombination, such as the Y-chromosome).  Partially linked STRs with
non-arbitrary locations cannot be modelled with this software.  Microsat
extends an algorithm initially developed by Richard Hudson, with his
permission.

The original code can be found here:
http://home.uchicago.edu/~rhudson1/source/mksamples.html


Compilation: gcc -o microsat microsat.c rand1.c -lm


Usage: microsat [-a anc_state] [-l n_linked_sites theta_prop1 ...
theta_prop_n] [-i]

Options: The -a flag sets the ancestral STR repeat size (i.e., an
integer such as 15).  The default ancestral state is 0.

The -l flag turns on multiple fully-linked STRs.  The default is a
single STR locus.  The user can define an arbitrary number of linked
STRs ('n_linked_sites'), but must specify the proportion of theta
assignable to each STR locus. The simulation theta value (used by ms)
should be the sum of individual thetas for each locus.

The -i flag outputs a format suitable, with slight modification, for use
with Jody Hey's IM.  The default output is a tab-delimited array of
microsatellites written to a single line.


Validation: For constant sized populations, the mean expected variance
of a microsatellite STR locus is half theta; E(V) = theta/2.


Example: ms 10 5 -t 4.0 | microsat -a 30 -l 2 0.4 0.6 > msat.dat
